# RAG Microservice

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (RAG-–ø–æ–¥—Ö–æ–¥).

## üöÄ –ó–∞–ø—É—Å–∫

```bash
cp .env.example .env
docker compose up --build
```

## üìÇ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### `/api/search_data/`

**POST**  
**–ü–æ–ª—è:**
- `file`: –¥–æ–∫—É–º–µ–Ω—Ç
- `query`: —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "results": [
    {
      "chunk": "...",
      "cosine_distance": 0.12,
      "semantic_metric": 0.88
    }
  ]
}
```

---

### `/api/chat_llm/`

**POST**  
**–ü–æ–ª—è:**
- `file`: –¥–æ–∫—É–º–µ–Ω—Ç
- `query`: –≤–æ–ø—Ä–æ—Å
- `prompt`: —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "response": "–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏..."
}
```

## üìì Swagger UI

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
```
http://localhost:8000/docs
```

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/your-username/rag_microservice.git
   cd rag_microservice
   ```

2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ:
   ```bash
   python -m venv venv
   source venv/bin/activate
   ```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```

4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:
   ```bash
   uvicorn main:app --reload
   ```

5. Swagger UI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
   ```
   http://127.0.0.1:8000/docs
   ```

---

## üì° –í—ã–∑–æ–≤ endpoints

- `/api/search_data` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª –∏ –∑–∞–ø—Ä–æ—Å (query), –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤.
- `/api/chat_llm` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª, –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–æ–º–ø—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ —á–∞—Ç–∞.

–û–±–∞ endpoint'–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Swagger-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `http://127.0.0.1:8000/docs`

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –∏ –º–æ–∫–∏

- –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –≤–º–µ—Å—Ç–æ OpenAI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–º–æ–∫-–æ—Ç–≤–µ—Ç** ‚Äî –º–æ–¥–µ–ª—å –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∞.
- –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–ª–∏—á–∏—è API-–∫–ª—é—á–∞.
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `services/embedder.py` –∏ `api/chat.py`.

---

## üõ† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–æ–∫—Å–∏)

–ï—Å–ª–∏ —É –≤–∞—Å –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏, –∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫–∏ –≤–∏–¥–∞ "Unknown scheme for proxy URL", –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
unset http_proxy
unset https_proxy
unset ftp_proxy
unset HTTP_PROXY
unset HTTPS_PROXY
unset FTP_PROXY
unset all_proxy
unset ALL_PROXY
```