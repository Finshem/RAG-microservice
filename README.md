# RAG Microservice

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (RAG-–ø–æ–¥—Ö–æ–¥).

## üöÄ –ó–∞–ø—É—Å–∫

```bash
cp .env.example .env
docker compose up --build
```

## üìÇ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### `/api/search_data/`

**Request:**

–§–∞–π–ª: `example.pdf`  
–¢–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞: `"–ö–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ RAG?"`

**Response:**
```json
[
  {
    "chunk": "–í RAG –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ NLP –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.",
    "cosine_distance": 0.123,
    "semantic_metric": 0.876
  },
  {
    "chunk": "–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è RAG –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞.",
    "cosine_distance": 0.456,
    "semantic_metric": 0.765
  }
]
```

---

### `/api/chat_llm/`

**Request:**

–§–∞–π–ª: `example.txt`  
–¢–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞: `"–û–±—ä—è—Å–Ω–∏ –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã RAG."`  
–ü—Ä–æ–º–ø—Ç: `"–û—Ç–≤–µ—Ç—å –∫–∞–∫ —ç–∫—Å–ø–µ—Ä—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è."`

**Response:**
```json
{
  "response": "RAG ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ—á–Ω—ã—Ö –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤."
}

```

## üìì Swagger UI

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
```
http://localhost:8000/docs
```

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/Finshem/RAG-microservice.git
   cd rag_microservice
   ```

2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   cp .env.example .env
   ```

3. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
   ```bash
   docker compose up --build
   ```

4. Swagger UI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
   ```
   http://127.0.0.1:8000/docs
   ```

---

## üì° –í—ã–∑–æ–≤ endpoints

- `/api/search_data` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª –∏ –∑–∞–ø—Ä–æ—Å (query), –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤.
- `/api/chat_llm` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª, –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–æ–º–ø—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ —á–∞—Ç–∞.

–û–±–∞ endpoint'–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Swagger-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `http://127.0.0.1:8000/docs`

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –∏ –º–æ–∫–∏

- –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –≤–º–µ—Å—Ç–æ OpenAI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–º–æ–∫-–æ—Ç–≤–µ—Ç** ‚Äî –º–æ–¥–µ–ª—å –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∞.
- –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–ª–∏—á–∏—è API-–∫–ª—é—á–∞.
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `services/embedder.py` –∏ `api/chat.py`.

---

## üõ† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–æ–∫—Å–∏)

–ï—Å–ª–∏ —É –≤–∞—Å –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏, –∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫–∏ –≤–∏–¥–∞ "Unknown scheme for proxy URL", –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
unset http_proxy
unset https_proxy
unset ftp_proxy
unset HTTP_PROXY
unset HTTPS_PROXY
unset FTP_PROXY
unset all_proxy
unset ALL_PROXY
```
